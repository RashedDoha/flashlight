load("@fbcode_macros//build_defs:cpp_unittest.bzl", "cpp_unittest")

cpp_unittest(
    name = "freelist_test",
    srcs = [
        "FreeListTest.cpp",
    ],
    tags = ["re_opts:platform=LINUX_GPU,size=XXLARGE"],
    deps = [
        "//deeplearning/projects/flashlight/flashlight/common:common",
        "//deeplearning/projects/flashlight/flashlight/experimental/memory:experimental_memory",
    ],
    external_deps = [
        ("googletest", None, "gtest"),
    ],
)

cpp_unittest(
    name = "memorypool_test",
    srcs = [
        "MemoryPoolTest.cpp",
    ],
    tags = ["re_opts:platform=LINUX_GPU,size=XXLARGE"],
    deps = [
        "//deeplearning/projects/flashlight/flashlight/common:common",
        "//deeplearning/projects/flashlight/flashlight/experimental/memory:experimental_memory",
    ],
    external_deps = [
        ("googletest", None, "gtest"),
    ],
)

cpp_unittest(
    name = "composite_memory_allocator_test",
    srcs = [
        "CompositeMemoryAllocatorTest.cpp",
    ],
    tags = ["re_opts:platform=LINUX_GPU,size=XXLARGE"],
    deps = [
        "//deeplearning/projects/flashlight/flashlight/common:common",
        "//deeplearning/projects/flashlight/flashlight/experimental/memory:experimental_memory",
    ],
    external_deps = [
        ("googletest", None, "gtest"),
    ],
)

cpp_unittest(
    name = "configurable_memory_allocator_test",
    srcs = [
        "ConfigurableMemoryAllocatorTest.cpp",
    ],
    tags = ["re_opts:platform=LINUX_GPU,size=XXLARGE"],
    deps = [
        "//deeplearning/projects/flashlight/flashlight/common:common",
        "//deeplearning/projects/flashlight/flashlight/experimental/memory:experimental_memory",
    ],
    external_deps = [
        ("googletest", None, "gtest"),
    ],
)
